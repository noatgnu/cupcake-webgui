<div class="modal-header">
  <h5 class="modal-title">
    <i class="bi bi-play-circle me-2"></i>
    Create New Session
  </h5>
  <button type="button" class="btn-close" (click)="cancel()" [disabled]="saving"></button>
</div>

<div class="modal-body">
  <form [formGroup]="sessionForm">
    <div class="alert alert-info mb-3">
      <i class="bi bi-info-circle me-2"></i>
      <strong>Protocol:</strong> {{ protocol.protocolTitle }}
    </div>

    <div class="mb-3">
      <label for="sessionName" class="form-label">
        Session Name <span class="text-danger">*</span>
      </label>
      <input
        type="text"
        class="form-control"
        id="sessionName"
        formControlName="name"
        placeholder="e.g., Experiment 2025-01-15"
        [class.is-invalid]="sessionForm.get('name')?.invalid && sessionForm.get('name')?.touched">
      @if (sessionForm.get('name')?.invalid && sessionForm.get('name')?.touched) {
        <div class="invalid-feedback">
          Session name is required
        </div>
      }
      <div class="form-text">
        Give this experimental session a descriptive name
      </div>
    </div>

    <div class="mb-3">
      <div class="form-check">
        <input
          class="form-check-input"
          type="checkbox"
          id="enabled"
          formControlName="enabled">
        <label class="form-check-label" for="enabled">
          Public
        </label>
      </div>
      <div class="form-text">
        Make this session viewable to everyone
      </div>
    </div>

    <div class="alert alert-warning mb-0">
      <i class="bi bi-exclamation-triangle me-2"></i>
      <small>A new session will be created for this protocol. You can add more protocols to the session later.</small>
    </div>
  </form>
</div>

<div class="modal-footer">
  <button type="button" class="btn btn-secondary" (click)="cancel()" [disabled]="saving">
    Cancel
  </button>
  <button
    type="button"
    class="btn btn-primary"
    (click)="createSession()"
    [disabled]="!sessionForm.valid || saving">
    @if (saving) {
      <span class="spinner-border spinner-border-sm me-1"></span>
    }
    <i class="bi bi-play-circle me-1"></i>
    Create & Start Session
  </button>
</div>
